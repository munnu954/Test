import com.google.gson.JsonObject;

import java.util.*;
import java.util.stream.Collectors;

public class CsvToJsonConverter {

    public static List<JsonObject> convertCsvToJson(List<String> csvData) {
        List<JsonObject> jsonObjects = new ArrayList<>();
        Stack<JsonObject> stack = new Stack<>();
        JsonObject currentObject = null;

        for (String line : csvData) {
            String[] values = line.split(",");
            List<String> nonEmptyValues = Arrays.stream(values).map(String::trim).filter(s -> !s.isEmpty()).collect(Collectors.toList());

            if (!nonEmptyValues.isEmpty()) {
                int level = nonEmptyValues.size();
                if (stack.size() < level) {
                    currentObject = new JsonObject();
                    stack.push(currentObject);
                } else if (stack.size() > level) {
                    while (stack.size() > level) {
                        stack.pop();
                    }
                    currentObject = stack.peek();
                }

                for (int i = 0; i < nonEmptyValues.size(); i++) {
                    String key = nonEmptyValues.get(i);
                    if (i == 0) {
                        currentObject.addProperty("ObjectName", key);
                    } else {
                        currentObject.addProperty(key, nonEmptyValues.get(++i));
                    }
                }
            }

            if (currentObject != null) {
                jsonObjects.add(currentObject.deepCopy());
            }
        }

        return jsonObjects;
    }
}
