// Inside the try block where you read the CSV file and set up the transformation
UnifiedAuditMessage auditMessage = new UnifiedAuditMessage();
auditMessage.setProcessType(ProcessType.TRANSFORMER);
auditMessage.setInputFilePath(path);
auditMessage.setUr(/* set UR value */);
auditMessage.setPort(/* set port value */);
auditMessage.setOutputFilePath(/* set output file path */);
auditMessage.setDelimiters(/* set delimiters */);
auditMessage.setFileType(/* set file type */);
auditMessage.setCollectorId(/* set collector ID */);
auditMessage.setDateReceived(LocalDateTime.now());
auditMessage.setDateProcessed(/* set date processed */);
auditMessage.setJobId(/* set job ID */);
auditMessage.setJarId(/* set JAR ID */);
auditMessage.setNumOfRecords(/* set number of records */);
auditMessage.setNumOfRecordsProcessed(/* set number of records processed */);
auditMessage.setNumOfRecordsFailed(/* set number of records failed */);

// For a successful transformation job
if (transformationSuccessful) {
    auditMessage.setJobStatus(JobStatus.FLINK_JOB_SUCCESSFUL);
} else {
    auditMessage.setJobStatus(JobStatus.FLINK_JOB_FAILED);
}

// Publish the audit message to the specified queue
kafkaPushMessages.pushToKafka(auditMessage);
