@Test
void mergeArrayMethod_withTagFromDbAndAlarm_shouldConvertTagToStringArrayAndAddTagsToSet() throws Exception {

    String[] expectedTagArray = {"tag1", "tag2"};

    when(mockSerialArray.getArray()).thenReturn(expectedTagArray);

    when(mockAlarm.getTag()).thenReturn(expectedTagArray);

    Method convertTagToStringArrayMethod = AlarmRepositoryImpl.class.getDeclaredMethod("convertTagToStringArray", Object.class);
    convertTagToStringArrayMethod.setAccessible(true);

    Method addTagsToSetMethod = AlarmRepositoryImpl.class.getDeclaredMethod("addTagsToSet", String[].class);
    addTagsToSetMethod.setAccessible(true);

    // Act
    Set<String> actualTags = (Set<String>) addTagsToSetMethod.invoke(alarmRepositoryImpl, mockSerialArray, mockAlarm);

    // Assert

    verify(mockSerialArray, times(1)).getArray();

    verify(alarmRepositoryImpl, times(1)).convertTagToStringArray(mockSerialArray);
    verify(alarmRepositoryImpl, times(1)).addTagsToSet(expectedTagArray);
    assertTrue(actualTags instanceof Set);
    assertEquals(expectedTagArray.length, actualTags.size());

    assertTrue(actualTags.containsAll(Arrays.asList(expectedTagArray)));
}