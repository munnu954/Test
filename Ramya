import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

public class CsvToJsonConversion {

    public static List<Map<String, Object>> convertCsvToJson(List<String> csvData) {
        List<Map<String, Object>> result = new ArrayList<>();
        Map<String, Object> currentObject = new HashMap<>();

        for (String line : csvData) {
            String[] columns = line.split(",");

            if (columns.length == 1 && !columns[0].isEmpty()) {
                // New object name
                currentObject = new HashMap<>();
                currentObject.put("ObjectName", columns[0].trim());
                result.add(currentObject);
            } else if (columns.length >= 2) {
                // Section data
                Map<String, Object> section = new HashMap<>();
                section.put("ObjectName", "");
                section.put("Begin Date", columns[1].trim());
                section.put("End Date", "");
                section.put("Ticket Number", columns[3].trim());

                Map<String, Object> details = new HashMap<>();
                details.put("Min", columns[6].trim());
                details.put("Average", columns[7].trim());
                details.put("Max", columns[8].trim());
                details.put("Cumulative Counter Value", columns[9].trim());

                section.put(columns[2].trim(), details);
                currentObject.put(columns[2].trim(), section);
            }
        }

        return result;
    }

    public static List<String> readCsvFromFile(String filePath) throws IOException {
        return Files.lines(Path.of(filePath)).collect(Collectors.toList());
    }

    public static void main(String[] args) {
        try {
            // Replace "your_file_path.csv" with the actual path to your CSV file
            List<String> csvData = readCsvFromFile("your_file_path.csv");

            List<Map<String, Object>> jsonResult = convertCsvToJson(csvData);
            System.out.println(jsonResult);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

