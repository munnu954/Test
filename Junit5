import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class CollectionAuditTest {

    @Test
    void testEquals_SameObject() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertTrue(audit1.equals(audit1));
    }

    @Test
    void testEquals_DifferentObject_DifferentId() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("2", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentCollectorId() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector2", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentProcessType() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Transformer, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentJarId() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar2", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentJobId() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job2", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentFlinkJobId() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob2", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentJobStatus() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "FAILED", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentInputFilePath() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input2.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentOutputFilePath() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output2.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentAuditTopic() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output2.txt", "auditTopic2", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentUrl() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example2.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentFlinkUrl() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink2.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentPort() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8081, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentDelimiters() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, "|", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentFileType() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "json", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentDateReceived() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-27", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentDateProcessed() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-27", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentNoOfRecordsInTheFile() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 101, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentNoOfRecordsProcessed() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 91, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentNoOfRecordsFailed() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 11, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_DifferentObject_DifferentExceptions() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions2", "localhost:9092");
        assertFalse(audit1.equals(audit2));
    }

    @Test
    void testEquals_NullObject() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals(null));
    }

    @Test
    void testEquals_DifferentClass() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertFalse(audit1.equals("test"));
    }

    @Test
    void testEquals_SameValues() {
        CollectionAudit audit1 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        CollectionAudit audit2 = new CollectionAudit("1", "collector1", ProcessType.Collector, "jar1", "job1", "flinkJob1", "RUNNING", "input.txt", "output.txt", "auditTopic", "http://example.com", "http://flink.example.com", 8080, ",", "csv", "2023-10-26", "2023-10-26", 100, 90, 10, "exceptions", "localhost:9092");
        assertTrue(audit1.equals(audit2));
    }
}