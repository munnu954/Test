import org.junit.jupiter.api.Test;
import static org.mockito.Mockito.*;

class YourTestClassTest {
    @Test
    void consume_ShouldNotWriteToExternalFileAndAuditQueue_WhenInputFileExistsAndTopicAccessible() throws IOException, ExecutionException, InterruptedException {
        // Arrange
        KafkaConsumer kafkaConsumer = spy(new KafkaConsumer());
        kafkaConsumer.util = util;
        doReturn(false).when(util).isKafkaTopicPresent(anyString()); // Simulating topic accessible
        doNothing().when(kafkaConsumer).writeLogToFile(any(FileMetadata.class), anyString());

        SpaceCollector spaceCollector = new SpaceCollector();
        spaceCollector.setInputFilePath("C:/Temp/input.xml");
        String data = "{\"inputFilePath\":\"C:/Temp/input.xml\"}";

        // Act
        kafkaConsumer.consume(data);

        // Assert
        verify(kafkaConsumer, never()).writeLogToFile(any(), any());
        verify(kafkaConsumer, never()).kafkaInputProducer.sendFailureMessage(any(), any(), any());
    }
}