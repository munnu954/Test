AI ðŸ¤–:
The error message is telling you that the argument passed to when() is not a mock. This means that the variable util is not a mock object. To fix this, you need to create a mock object for Util and then pass it to when().

Here is an example of how to do this:


@Mock
private Util util;

@Test
void consume_ShouldNotWriteToExternalFileAndAuditQueue_WhenInputFileExistsAndTopicAccessible() throws IOException, ExecutionException, InterruptedException {
        // Arrange
        MockitoAnnotations.initMocks(this);

        Util mockUtil = Mockito.mock(Util.class);
        when(mockUtil.isKafkaTopicPresent(any())).thenReturn(true); // Simulating topic accessible
        doNothing().when(kafkaConsumer).writeLogToFile(any(), any());

        SpaceCollector spaceCollector = new SpaceCollector();
        spaceCollector.setInputFilePath("C:/Temp/input.xml");
        String data = "{\"inputFilePath\":\"C:/Temp/input.xml\"}";

        // Act
        kafkaConsumer.consume(data);

        // Assert
        verify(kafkaConsumer, never()).writeLogToFile(any(), any());
        verify(kafkaConsumer, never()).kafkaInputProducer.sendFailureMessage(any(), any(), any());
    }


This code creates a mock object for Util and then passes it to when(). This ensures that the argument passed to when() is a mock object.

I hope this helps!