The error "Cannot invoke 'String.length()' because 'str' is null" suggests that there might be a null value in one of the strings being processed, likely in the `LISTAGG` function. To prevent this, you can use the `NVL()` function to handle any null values within `fiber_num`.

Here's the revised query:

```sql
SELECT DISTINCT clli_a, clli_z, complement_name AS cable_name, LISTAGG(NVL(fiber_num, ''), '') AS fiber_num FROM gisfim.fiber_layout_record WHERE (fiber_circuit_id = :circuitId OR NFID = :nfid) AND status IS NOT NULL AND status <> 'CANCELLED' GROUP BY clli_a, clli_z, complement_name
```

This modification uses `NVL(fiber_num, '')` to replace any null `fiber_num` values with an empty string, thereby avoiding the null-related error.