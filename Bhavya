@Test
public void testTriggerJobSuccess() {
    UnifiedAuditMessage auditMsg = new UnifiedAuditMessage();
    String fileType = ".csv";
    String inputFilePath = "/path/to/input/file";
    String programArgs = "input=" + inputFilePath;
    String jobSubmitUrl = "http://flink-api-url/jars/jar-id/run";
    String responseBody = "{\"jobid\": \"123456789\"}";

    when(kafkaConsumer.logMetadata(auditMsg, fileType, null)).thenReturn(auditMsg);
    when(restTemplate.postForEntity(jobSubmitUrl, any(), eq(String.class))).thenReturn(new ResponseEntity<>(responseBody, HttpStatus.OK));

    String result = flinkApiController.triggerJob(auditMsg, fileType);

    verify(kafkaAuditProducer, times(1)).createMessageAndLog(inputFilePath, null, null, null, null, fileType, anyString(), anyInt(), anyInt(), anyInt(), anyString(), anyString(), anyList(), eq(JobStatus.FLINK_JOB_SUBMITTED.toString()));
    assertEquals("Job submitted", result);
}