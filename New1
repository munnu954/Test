To add the "enrichGigamonFlatMap" functionality to the Main.java class using a switch case, you can modify the CsvtoJsonTransformer class as follows:

CsvtoJsonTransformer.java:-

import org.apache.flink.api.common.functions.FlatMapFunction;
import org.apache.flink.util.Collector;
import org.json.JSONObject;

public class CsvtoJsonTransformer implements FlatMapFunction<String, String> {
    private String[] headers;
    private String fileType;

    public CsvtoJsonTransformer(String fileType) {
        this.fileType = fileType;
    }

    @Override
    public void flatMap(String s, Collector<String> collector) throws Exception {
        String[] arr = s.split(",");
        JSONObject obj = new JSONObject();
        int i = 1;
        String jsonkey;
        for (String input : arr) {
            jsonkey = "key" + i;
            obj.put(jsonkey, input);
            i++;
        }
        collector.collect(obj.toString());
    }

    public void enrichGigamonFlatMap(String s, Collector<String> collector) throws Exception {
        String[] arr = s.split(",");
        if (headers == null) {
            headers = arr; // Store the header row for key names
            return; // Skip processing the header row
        }

        JSONObject obj = new JSONObject();
        for (int i = 0; i < arr.length; i++) {
            String jsonkey = headers[i].trim();
            String jsonValue = arr[i].trim().replace("\"", ""); // Remove any quotes around the value
            obj.put(jsonkey, jsonValue);
        }
        collector.collect(obj.toString());
    }

    @Override
    public void flatMap(String s, Collector<String> collector) throws Exception {
        switch (fileType) {
            case "Gigamon":
                enrichGigamonFlatMap(s, collector);
                break;
            default:
                flatMap(s, collector);
                break;
        }
    }
}

Now, in the Main.java class, you can create an instance of the CsvtoJsonTransformer class and specify the file type as "Gigamon" when calling the flatMap method:

Main.java:-

...

final DataStream<String> jsonStream = stream.flatMap(new CsvtoJsonTransformer("Gigamon"));
jsonStream.sinkTo(sink);
env.execute();

By specifying the file type as "Gigamon", it will use the enrichGigamonFlatMap method in the CsvtoJsonTransformer class to transform the CSV data to JSON format for Gigamon files. For other file types, it will use the regular flatMap method.