catch (HttpClientErrorException | HttpServerErrorException ex) {
    ex.printStackTrace();
    LOGGER.error("Error triggering job", ex.getMessage());

    if (ex instanceof HttpServerErrorException) {
        // If it's an Internal Server Error, you might want to inspect its body to get more details
        String responseBody = ((HttpServerErrorException) ex).getResponseBodyAsString();
        LOGGER.error("Server Error Response: " + responseBody);

        // Now, let's try to parse the response body
        try {
            JSONObject errorDetails = new JSONObject(responseBody);
            // Assuming the server returns a JSON object with some error details
            // Extract the relevant information and log it
            LOGGER.error("Server Error Details: " + errorDetails.toString(2)); // Assuming we want to pretty print the JSON
        } catch (JSONException jsonException) {
            LOGGER.error("Unable to parse error details: " + jsonException.getMessage());
        }
    }

    FileMetadata metadata = kafkaConsumer.logMetadata(collector, fileType, ex);

    kafkaInputProducer.sendFailureMessage(collector, fileType, ex);
    kafkaConsumer.writeLogToFile(metadata, destinationFolderPath);
}