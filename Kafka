public void sendMessage(Unified AuditMessage auditMsg, String fileType, ResponseEntity response, boolean isSuccess, Exception e) {
  auditMsg.setInputFilePath(auditMsg.getInputFilePath());
  auditMsg.setUrl(auditMsg.getUrl());
  auditMsg.setPort(auditMsg.getPort());
  auditMsg.setOutputFilePath(auditMsg.getOutputFilePath());
  auditMsg.setDelimiters(auditMsg.getDelimiters());
  auditMsg.setFileType(fileType);
  auditMsg.setDate_received(DateTime.now());
  auditMsg.setDate_processed(isSuccess ? DateTime.now() : null);
  auditMsg.setNo_of_records_in_the_file(0);
  auditMsg.setNo_of_records_processed(0);
  auditMsg.setNo_of_records_failed(0);
  auditMsg.setJob_status(isSuccess ? JobStatus.COLLECTION_SUCCESSFUL : JobStatus.COLLECTION_FAILED);
  auditMsg.setJob_id(UUID.randomUUID());
  auditMsg.setJar_id(UUID.randomUUID());
  if (response != null) {
    auditMsg.setExceptions(List.of(response.getStatusCode().toString()));
  } else if (e != null) {
    auditMsg.setExceptions(List.of(e.getMessage()));
  }
  Logger.info(String.format("%s message sent %s", isSuccess ? "Success" : "Failure", auditMsg));
  this.writeMessage(auditMsg);
}






The updated code will look like this:

```java
else{
    LOGGER.info("Not Ok!!");
    
    UnifiedAuditMessage auditData = new UnifiedAuditMessage(
        auditMsg.getInputFilePath(), auditMsg.getUrl(), auditMsg.getPort(), auditMsg.getOutputFilePath(),
        auditMsg.getDelimiters(), auditMsg.getFileType(), auditMsg.getDate_received(),
        auditMsg.getNo_of_records_in_the_file(), auditMsg.getNo_of_records_processed(),
        auditMsg.getNo_of_records_failed(), auditMsg.getJob_id(), auditMsg.getJar_id(),
        auditMsg.getCollector_id(), auditMsg.getJob_status()
    );

    kafkaConsumer.logMetadata(auditData, fileType, response);

    kafkaAuditProducer.sendMessage(auditData, fileType, response, false);

    kafkaConsumer.writeLogToFile(auditData, fileType, response, destinationFolderPath);

}
```