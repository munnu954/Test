Feature: Retrieving audit status map for SFTP files

  Scenario: Retrieve audit status map for a list of less than 1000 files
    Given an empty list of SFTP files
    When getAuditStatusMap is called with the remote directory "/remote/dir"
    Then the audit status map should be empty

  Scenario: Retrieve audit status map for a list of exactly 1000 files
    Given a list of 1000 SFTP files
    And each file is not a directory
    And the remote directory is "/remote/dir"
    And the audit repository returns the latest audits for these files
    When getAuditStatusMap is called with the remote directory "/remote/dir"
    Then the audit status map should contain 1000 entries
    And each entry should have a status of "STATUS"

  Scenario: Retrieve audit status map for a list of more than 1000 files
    Given a list of 1500 SFTP files
    And each file is not a directory
    And the remote directory is "/remote/dir"
    And the audit repository returns the latest audits for the first 1000 files
    And the audit repository returns the latest audits for the remaining 500 files
    When getAuditStatusMap is called with the remote directory "/remote/dir"
    Then the audit status map should contain 1500 entries
    And each entry should have a status of "STATUS"
