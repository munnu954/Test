import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.assertEquals;

public class CollectionAuditTest {

    @Test
    public void testBuilder() {
        CollectionAudit collectionAudit = CollectionAudit.builder()
                .id("1")
                .collectorId("c1")
                .processType(ProcessType.Collector)
                .jarId("j1")
                .jobId("job1")
                .flinkJobId("f1")
                .jobStatus("completed")
                .inputFilePath("input.txt")
                .outputFilePath("output.txt")
                .auditTopic("topic1")
                .url("http://example.com")
                .flinkURL("http://flink.com")
                .port(8080)
                .delimiters(",")
                .fileType("csv")
                .dateReceived("2022-01-01")
                .dateProcessed("2022-01-02")
                .noofRecordsInTheFile(100)
                .noofRecordsProcessed(90)
                .noofRecordsFailed(10)
                .exceptions("error")
                .bootstrapServer("localhost:9092")
                .build();

        assertEquals("1", collectionAudit.getId());
        assertEquals("c1", collectionAudit.getCollectorId());
        assertEquals(ProcessType.Collector, collectionAudit.getProcessType());
        assertEquals("j1", collectionAudit.getJarId());
        assertEquals("job1", collectionAudit.getJobId());
        assertEquals("f1", collectionAudit.getFlinkJobId());
        assertEquals("completed", collectionAudit.getJobStatus());
        assertEquals("input.txt", collectionAudit.getInputFilePath());
        assertEquals("output.txt", collectionAudit.getOutputFilePath());
        assertEquals("http://example.com", collectionAudit.getUrl());
        assertEquals("http://flink.com", collectionAudit.getFlinkURL());
        assertEquals(8080, collectionAudit.getPort());
        assertEquals(",", collectionAudit.getDelimiters());
        assertEquals("csv", collectionAudit.getFileType());
        assertEquals("2022-01-01", collectionAudit.getDateReceived());
        assertEquals("2022-01-02", collectionAudit.getDateProcessed());
        assertEquals(100, collectionAudit.getNoofRecordsInTheFile());
        assertEquals(90, collectionAudit.getNoofRecordsProcessed());
        assertEquals(10, collectionAudit.getNoofRecordsFailed());
        assertEquals("error", collectionAudit.getExceptions());
        assertEquals("localhost:9092", collectionAudit.getBootstrapServer());
    }
}