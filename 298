import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.mockito.Mockito.*;

import org.junit.jupiter.api.Test;

public class FlinkApiControllerTest {

    @Test
    public void testTriggerJob_Failure() {
        // Arrange
        String fileType = ".csv";
        SpaceCollector collector = new SpaceCollector();
        FlinkApiController flinkApiController = mock(FlinkApiController.class);

        // Mock FlinkApiController behavior to throw exception
        when(flinkApiController.triggerJob(eq(collector), eq(fileType))).thenThrow(new RuntimeException("Job submission failed"));

        // Act
        String result = "";
        try {
            result = flinkApiController.triggerJob(collector, fileType);
        } catch (RuntimeException e) {
            result = "Job submission failed";
        }

        // Assert
        assertEquals("Job submission failed", result, "Job submission should fail");
        verify(flinkApiController, atLeastOnce()).triggerJob(eq(collector), eq(fileType));
    }
}