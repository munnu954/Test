import org.pojava.datetime.DateTime;
import java.util.UUID;
import java.util.List;

public void sendMessage(UnifiedAuditMessage auditMsg, String fileType, ResponseEntity response, boolean isSuccess) {
    UnifiedAuditMessage auditData = new UnifiedAuditMessage();
    auditData.setInputFilePath(auditMsg.getInputFilePath());
    auditData.setUrl(auditMsg.getUrl());
    auditData.setPort(auditMsg.getPort());
    auditData.setOutputFilePath(auditMsg.getOutputFilePath());
    auditData.setDelimiters(auditMsg.getDelimiters());
    auditData.setFileType(fileType);
    auditData.setDate_received(DateTime.now());
    auditData.setDate_processed(isSuccess ? DateTime.now() : null);
    auditData.setNo_of_records_in_the_file(0);
    auditData.setNo_of_records_processed(0);
    auditData.setNo_of_records_failed(0);
    auditData.setJob_status(isSuccess ? JobStatus.COLLECTION_SUCCESSFUL : JobStatus.COLLECTION_FAILED);
    auditData.setJob_id(UUID.randomUUID());
    auditData.setJar_id(UUID.randomUUID());
    auditData.setExceptions(List.of(response.getStatusCode().toString()));
    auditData.setCollector_id(UUID.randomUUID());

    Logger.info("{} message sent: {}", isSuccess ? "Success" : "Failure", auditData);
    this.writeMessage(auditData);
}

public enum JobStatus {
    COLLECTION_NEW,
    COLLECTION_IN_PROGRESS,
    COLLECTION_SUCCESSFUL,
    COLLECTION_FAILED,
    FLINK_JOB_NEW,
    FLINK_JOB_SUBMITTED,
    FLINK_JOB_IN_PROGRESS,
    FLINK_JOB_SUCCESSFUL,
    FLINK_JOB_FAILED
}