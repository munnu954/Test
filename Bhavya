@Test
public void testScheduleBatchJob_WithRecords() throws Exception {
    // Arrange
    when(sqlservice.hasRecords()).thenReturn(true);
    JobExecution jobExecution = mock(JobExecution.class);
    
    // Use LocalDateTime for start and end times
    LocalDateTime startTime = LocalDateTime.now();
    LocalDateTime endTime = startTime.plusMinutes(1);

    // Mocking the JobExecution behavior to return LocalDateTime
    when(jobExecution.getStartTime()).thenReturn(Date.from(startTime.atZone(ZoneId.systemDefault()).toInstant()));
    when(jobExecution.getEndTime()).thenReturn(Date.from(endTime.atZone(ZoneId.systemDefault()).toInstant()));
    when(jobLauncher.run(any(Job.class), any(JobParameters.class))).thenReturn(jobExecution);

    // Act
    kafkaFalloutScheduler.scheduleBatchJob();

    // Assert
    verify(logger).info("KafkaFalloutScheduler::Batch job starting");
    verify(jobLauncher).run(any(Job.class), any(JobParameters.class));
    verify(logger).info(contains("Batch job ending with Id:"));
}
