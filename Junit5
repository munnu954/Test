@Test
void parseWithValidJsonFieldAndArrayIndex() throws Exception {
    // Arrange
    String expression = "%attribute1:details.names[0]%";
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    
    // Act
    String result= alarmPostingUtils.parse(expression, srcMap, "");
    
    // Assert
    assertEquals("John", result);
}

@Test
void parseWithInvalidJsonFieldAndArrayIndex() throws Exception {
    // Arrange
    String expression = "%attribute1:details.unknown[0]%";
    srcMap.put("details", Map.of("name", "John"));
    
    // Act
    String result= alarmPostingUtils.parse(expression, srcMap, "");
    
    // Assert
    assertEquals("", result);
}

@Test
void parseWithInvalidJsonFieldAndValidArrayIndex() throws Exception {
    // Arrange
    String expression = "%attribute1:details.unknown[0]%";
    srcMap.put("details", Map.of("unknown", List.of("John", "Jane")));
    
    // Act
    String result= alarmPostingUtils.parse(expression, srcMap, "");
    
    // Assert
    assertEquals("", result);
}

@Test
void parseWithNoArrayIndex() throws Exception {
    // Arrange
    String expression = "%attribute1:details.names%";
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    
    // Act
    String result= alarmPostingUtils.parse(expression, srcMap, "");
    
    // Assert
    assertEquals(List.of("John", "Jane").toString(), result);
}

@Test
void parseWithInvalidArrayIndexFormat() throws Exception {
    // Arrange
    String expression = "%attribute1:details.names[abc]%";
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    
    // Act
    String result= alarmPostingUtils.parse(expression, srcMap, "");
    
    // Assert
    assertEquals("", result);
}