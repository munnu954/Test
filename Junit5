import org.junit.jupiter.api.Test;
import org.springframework.boot.SpringApplication;
import org.springframework.context.ConfigurableApplicationContext;

import static org.mockito.Mockito.*;

public class CBRSSuppressionApplicationTest {

    @Test
    void testMainSuccess() {
        SpringApplication app = mock(SpringApplication.class);
        ConfigurableApplicationContext appContext = mock(ConfigurableApplicationContext.class);

        when(app.run(any(String[].class))).thenReturn(appContext);

        CBRSSuppressionApplication.main(new String[]{"arg1", "arg2"});

        verify(app).setBannerMode(Banner.Mode.OFF);
        verify(appContext).getBean(AlarmConsumer.class);
        verify(appContext).getBean(MessageReaderService.class);
    }

    @Test
    void testMainUnsatisfiedDependencyException() {
        UnsatisfiedDependencyException ex = mock(UnsatisfiedDependencyException.class);
        when(ex.getMessage()).thenReturn("Validation failed for query");

        SpringApplication app = mock(SpringApplication.class);
        ConfigurableApplicationContext appContext = mock(ConfigurableApplicationContext.class);

        when(app.run(any(String[].class))).thenThrow(ex);

        CBRSSuppressionApplication.main(new String[]{"arg1", "arg2"});

        verify(app).setBannerMode(Banner.Mode.OFF);
        verify(appContext, never()).getBean(AlarmConsumer.class);
        verify(appContext, never()).getBean(MessageReaderService.class);
    }
}