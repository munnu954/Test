<dependency>
    <groupId>org.apache.pdfbox</groupId>
    <artifactId>pdfbox</artifactId>
    <version>3.0.2</version> <!-- Use the latest available version -->
</dependency>
<dependency>
    <groupId>org.apache.poi</groupId>
    <artifactId>poi</artifactId>
    <version>5.2.3</version> <!-- Use latest available version -->
</dependency>
<dependency>
    <groupId>org.apache.poi</groupId>
    <artifactId>poi-ooxml</artifactId>
    <version>5.2.3</version> <!-- Use latest available version -->
</dependency>


_____________

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class PDFPageCounterToExcel {

    public static void main(String[] args) {
        String pdfFolderPath = "your/path/to/pdfs";
        String outputFile = pdfFolderPath + File.separator + "pdf_page_counts.xlsx";

        Workbook workbook = new XSSFWorkbook();
        Sheet sheet = workbook.createSheet("PDF Page Counts");

        // Add headers
        Row headerRow = sheet.createRow(0);
        headerRow.createCell(0).setCellValue("PDF File");
        headerRow.createCell(1).setCellValue("Page Count");

        File folder = new File(pdfFolderPath);
        File[] files = folder.listFiles();

        int rowNum = 1;
        if (files != null) {
            for (File file : files) {
                if (file.isFile() && file.getName().toLowerCase().endsWith(".pdf")) {
                    Row row = sheet.createRow(rowNum++);
                    row.createCell(0).setCellValue(file.getName());
                    try (PDDocument document = PDDocument.load(file)) {
                        int numPages = document.getNumberOfPages();
                        row.createCell(1).setCellValue(numPages);
                    } catch (Exception e) {
                        row.createCell(1).setCellValue("Error: " + e.getMessage());
                    }
                }
            }
        }

        // Auto-size columns
        sheet.autoSizeColumn(0);
        sheet.autoSizeColumn(1);

        try (FileOutputStream fileOut = new FileOutputStream(outputFile)) {
            workbook.write(fileOut);
            System.out.println("Done! Results saved in: " + outputFile);
        } catch (IOException e) {
            System.out.println("Error saving Excel file: " + e.getMessage());
        }
    }
}
