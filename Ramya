import com.google.gson.JsonObject;
import com.google.gson.JsonArray;
import java.util.HashMap;

public class CsvToJsonParser {

    public static void main(String[] args) {
        String[] input = {
            // Replace this array with your actual input lines
        };

        JsonArray resultArray = new JsonArray();
        JsonObject currentObject = null;

        for (String line : input) {
            String[] arr = line.split(",");

            if (arr.length > 2 && !arr[2].isEmpty()) {
                // This is the line containing ObjectName
                if (currentObject != null) {
                    resultArray.add(currentObject);
                }

                currentObject = new JsonObject();
                currentObject.addProperty("ObjectName", arr[2].trim());
                currentObject.addProperty("Begin Date", arr[1].trim());
                currentObject.addProperty("End Date", "");
                currentObject.addProperty("Ticket Number", "");
            } else if (arr.length > 0 && !arr[0].isEmpty()) {
                // This is a line containing SectionName
                String sectionName = arr[0].trim();
                JsonObject sectionObject = new JsonObject();

                sectionObject.addProperty("Min", arr[3].trim());
                sectionObject.addProperty("Average", arr[4].trim());
                sectionObject.addProperty("Max", arr[5].trim());
                sectionObject.addProperty("Cumulative Counter Value", arr[6].trim());

                if (currentObject != null) {
                    currentObject.add(sectionName, sectionObject);
                }
            }
        }

        // Add the final JSON structure for the last object
        if (currentObject != null) {
            resultArray.add(currentObject);
        }

        System.out.println(resultArray.toString());
    }
}
