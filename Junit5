@Test
void parseWithValidArrayIndexAndValidJsonField() throws Exception {
    // Arrange
    String expression = "%attribute1: details.names[1]%"; 
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("Jane", result);
}

@Test
void parseWithValidArrayIndexAndInvalidJsonField() throws Exception {
    // Arrange
    String expression = "%attribute1: details.unknown[1]%"; 
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("", result);
}

@Test
void parseWithInvalidArrayIndexAndValidJsonField() throws Exception {
    // Arrange
    String expression = "%attribute1: details.names[2]%"; 
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("", result);
}

@Test
void parseWithInvalidArrayIndexAndInvalidJsonField() throws Exception {
    // Arrange
    String expression = "%attribute1: details.unknown[2]%"; 
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("", result);
}

@Test
void parseWithValidJsonFieldAndArrayIndexOutOfBound() throws Exception {
    // Arrange
    String expression = "%attribute1: details.names[3]%"; 
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("", result);
}

@Test
void parseWithInvalidJsonFieldAndArrayIndexOutOfBound() throws Exception {
    // Arrange
    String expression = "%attribute1: details.unknown[3]%"; 
    srcMap.put("details", Map.of("names", List.of("John", "Jane")));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("", result);
}

@Test
void parseWithValidJsonFieldAndEmptyList() throws Exception {
    // Arrange
    String expression = "%attribute1: details.names[0]%"; 
    srcMap.put("details", Map.of("names", List.of()));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("", result);
}

@Test
void parseWithInvalidJsonFieldAndEmptyList() throws Exception {
    // Arrange
    String expression = "%attribute1: details.unknown[0]%"; 
    srcMap.put("details", Map.of("names", List.of()));
    // Act
    String result = alarmPostingUtils.parse(expression, srcMap, "");
    // Assert
    assertEquals("", result);
}