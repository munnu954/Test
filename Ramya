public class CsvtoJsonConversion implements FlatMapFunction<String, String> {

    private JsonObject currentObject;
    private String currentObjectName;

    @Override
    public void flatMap(String input, Collector<String> collector) throws Exception {
        String[] arr = input.split(",");

        // Check if the ObjectName is present
        if (!arr[2].trim().isEmpty()) {
            // Save the completed object
            if (currentObject != null) {
                collector.collect(currentObject.toString());
            }

            // Start a new object
            currentObjectName = arr[2].trim();
            currentObject = new JsonObject();
            currentObject.addProperty("ObjectName", currentObjectName);
            currentObject.addProperty("Begin date", arr[1].trim());  // Assuming Begin date is in the second column (index 1)
            currentObject.addProperty("End date", arr[3].trim());    // Assuming End date is in the fourth column (index 3)
            currentObject.addProperty("Ticket number", arr[4].trim());  // Assuming Ticket number is in the fifth column (index 4)
        } else {
            // Sub-object details
            JsonObject subObject = new JsonObject();
            subObject.addProperty("Min", arr[5].trim());
            subObject.addProperty("Average", arr[4].trim());
            subObject.addProperty("Max", arr[3].trim());
            subObject.addProperty("Cumulative counter value", arr[6].trim());

            // Add sub-object to the current object
            currentObject.add(arr[0].trim(), subObject);
        }
    }
}
