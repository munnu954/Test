
public UnifiedAuditMessage logMetadata(String inputFilePath, String url, int port, String outputFilePath, String delimiters, String fileType, DateTime dateReceived, DateTime dateProcessed, int noOfRecordsInTheFile, int noOfRecordsProcessed, int noOfRecordsFailed, UUID jobId, UUID jarId, List exceptions, String collectorId, JobStatus jobStatus) {
    UnifiedAuditMessage auditData = new UnifiedAuditMessage();
    auditData.setInputFilePath(inputFilePath);
    auditData.setUrl(url);
    auditData.setPort(port);
    auditData.setOutputFilePath(outputFilePath);
    auditData.setDelimiters(delimiters);
    auditData.setFileType(fileType);
    auditData.setDate_received(dateReceived);
    auditData.setDate_processed(dateProcessed);
    auditData.setNo_of_records_in_the_file(noOfRecordsInTheFile);
    auditData.setNo_of_records_processed(noOfRecordsProcessed);
    auditData.setNo_of_records_failed(noOfRecordsFailed);
    auditData.setJob_id(jobId);
    auditData.setJar_id(jarId);
    auditData.setExceptions(exceptions);
    auditData.setCollector_id(collectorId);
    auditData.setJob_status(jobStatus);
    return auditData;
}

public UnifiedAuditMessage logMetadata(UnifiedAuditMessage auditMsg, String fileType, ResponseEntity errorMessage) {
    return logMetadata(
        auditMsg.getInputFilePath(),
        auditMsg.getUrl(),
        auditMsg.getPort(),
        auditMsg.getOutputFilePath(),
        auditMsg.getDelimiters(),
        fileType,
        auditMsg.getDate_received(),
        auditMsg.getDate_processed(),
        auditMsg.getNo_of_records_in_the_file(),
        auditMsg.getNo_of_records_processed(),
        auditMsg.getNo_of_records_failed(),
        auditMsg.getJob_id(),
        auditMsg.getJar_id(),
        Collections.singletonList(errorMessage.getStatusCode().toString()),
        auditMsg.getCollector_id(),
        JobStatus.COLLECTION_FAILED
    );
}

public UnifiedAuditMessage logMetadata(UnifiedAuditMessage auditMsg, String fileType, Exception e) {
    return logMetadata(
        auditMsg.getInputFilePath(),
        auditMsg.getUrl(),
        auditMsg.getPort(),
        auditMsg.getOutputFilePath(),
        auditMsg.getDelimiters(),
        fileType,
        auditMsg.getDate_received(),
        auditMsg.getDate_processed(),
        auditMsg.getNo_of_records_in_the_file(),
        auditMsg.getNo_of_records_processed(),
        auditMsg.getNo_of_records_failed(),
        auditMsg.getJob_id(),
        auditMsg.getJar_id(),
        Collections.singletonList("Exception: " + e.getMessage()),
        auditMsg.getCollector_id(),
        JobStatus.COLLECTION_FAILED
    );
}

____________________


java
public UnifiedAuditMessage logMetadata(String inputFilePath, String url, int port, String outputFilePath, String delimiters, String fileType, DateTime dateReceived, DateTime dateProcessed, int noOfRecordsInTheFile, int noOfRecordsProcessed, int noOfRecordsFailed, UUID jobId, UUID jarId, List<String> exceptions, String collectorId, JobStatus jobStatus) {
    UnifiedAuditMessage auditData = new UnifiedAuditMessage();
    auditData.setInputFilePath(inputFilePath);
    auditData.setUrl(url);
    auditData.setPort(port);
    auditData.setOutputFilePath(outputFilePath);
    auditData.setDelimiters(delimiters);
    auditData.setFileType(fileType);
    auditData.setDate_received(dateReceived);
    auditData.setDate_processed(dateProcessed);
    auditData.setNo_of_records_in_the_file(noOfRecordsInTheFile);
    auditData.setNo_of_records_processed(noOfRecordsProcessed);
    auditData.setNo_of_records_failed(noOfRecordsFailed);
    auditData.setJob_id(jobId);
    auditData.setJar_id(jarId);
    auditData.setExceptions(exceptions);
    auditData.setCollector_id(collectorId);
    auditData.setJob_status(jobStatus);
    return auditData;
}

public UnifiedAuditMessage logMetadata(String inputFilePath, String url, int port, String outputFilePath, String delimiters, String fileType, DateTime dateReceived, DateTime dateProcessed, int noOfRecordsInTheFile, int noOfRecordsProcessed, int noOfRecordsFailed, UUID jobId, UUID jarId, Exception e) {
    UnifiedAuditMessage auditData = new UnifiedAuditMessage();
    auditData.setInputFilePath(inputFilePath);
    auditData.setUrl(url);
    auditData.setPort(port);
    auditData.setOutputFilePath(outputFilePath);
    auditData.setDelimiters(delimiters);
    auditData.setFileType(fileType);
    auditData.setDate_received(dateReceived);
    auditData.setDate_processed(dateProcessed);
    auditData.setNo_of_records_in_the_file(noOfRecordsInTheFile);
    auditData.setNo_of_records_processed(noOfRecordsProcessed);
    auditData.setNo_of_records_failed(noOfRecordsFailed);
    auditData.setJob_id(jobId);
    auditData.setJar_id(jarId);
    auditData.setExceptions(Collections.singletonList("Exception: " + e.getMessage()));
    auditData.setCollector_id(null);
    auditData.setJob_status(JobStatus.COLLECTION_FAILED);
    return auditData;
}