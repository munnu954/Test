Here is the modified flatMap method without storing and skipping the first line of the CSV file as headers:

@Override
public void flatMap(String s, Collector<String> collector) throws Exception {
    String[] lines = s.split(System.lineSeparator());
    
    boolean firstLine = true; // Flag to track the first line
    
    for (String str : lines) {
        String[] arr = str.split(",");
        
        if (!firstLine && headers.length == arr.length) {
            JSONObject obj = new JSONObject();
            for (int i = 0; i < arr.length; i++) {
                String jsonkey = String.valueOf(i);
                String jsonvalue = arr[i].trim().replace("\"", "");
                obj.put(jsonkey, jsonvalue);
            }
            this.successIntCounter.add(1);
            collector.collect(obj.toString());
        } else {
            this.failureIntCounter.add(1);
        }
        
        firstLine = false; // Set the firstLine flag to false after the first line is processed
    }
}


This updated code ensures that the first line of the CSV file is not stored as headers and is processed like the rest of the lines, maintaining the index as the key for each value in the resulting JSON object.