@Test
public void testKafkaConsumer() {
    // Mock consumer record
    ConsumerRecord<String, String> record = mock(ConsumerRecord.class);
    when(record.topic()).thenReturn("topic");
    when(record.offset()).thenReturn(0L);
    when(record.partition()).thenReturn(0);
    when(record.key()).thenReturn("key");
    when(record.value()).thenReturn("value");

    // Build the mock consumer records with the mock record
    ConsumerRecords<String, String> records =
            new ConsumerRecords<>(new HashMap<>());
    records.add(record);

    // Set up the behavior of the consumer
    when(consumer.poll(any(Duration.class))).thenReturn(records);

    // Call the consumer method
    consumer.poll(Duration.ofMillis(100));

    // Verify that the poll method was called once
    verify(consumer, times(1)).poll(Duration.ofMillis(100));
}