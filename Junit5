import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;

public class CollectionAuditTest {

    @Test
    public void testBuilder() {
        CollectionAudit collectionAudit = CollectionAudit.builder()
                .id("1")
                .collectorId("123")
                .processType(ProcessType.Collector)
                .jarId("456")
                .jobId("789")
                .flinkJobId("1234")
                .jobStatus("SUCCESS")
                .inputFilePath("/input/file.txt")
                .outputFilePath("/output/file.txt")
                .auditTopic("topic")
                .url("http://example.com")
                .flinkURL("http://flink.com")
                .port(8080)
                .delimiters(",")
                .fileType("csv")
                .dateReceived("2021-10-10")
                .dateProcessed("2021-10-11")
                .noOfRecordsInTheFile(100)
                .noOfRecordsProcessed(90)
                .noOfRecordsFailed(10)
                .exceptions("Exception occurred")
                .bootstrapServer("localhost:9092")
                .build();

        assertNotNull(collectionAudit);
        assertEquals("1", collectionAudit.getId());
        assertEquals("123", collectionAudit.getCollectorId());
        assertEquals(ProcessType.Collector, collectionAudit.getProcessType());
        assertEquals("456", collectionAudit.getJarId());
        assertEquals("SUCCESS", collectionAudit.getJobStatus());
        assertEquals("/input/file.txt", collectionAudit.getInputFilePath());
        assertEquals("/output/file.txt", collectionAudit.getOutputFilePath());
        assertEquals("http://example.com", collectionAudit.getUrl());
        assertEquals("http://flink.com", collectionAudit.getFlinkURL());
        assertEquals(8080, collectionAudit.getPort());
        assertEquals(",", collectionAudit.getDelimiters());
        assertEquals("csv", collectionAudit.getFileType());
        assertEquals("2021-10-10", collectionAudit.getDateReceived());
        assertEquals("2021-10-11", collectionAudit.getDateProcessed());
        assertEquals(100, collectionAudit.getNoOfRecordsInTheFile());
        assertEquals(90, collectionAudit.getNoOfRecordsProcessed());
        assertEquals(10, collectionAudit.getNoOfRecordsFailed());
        assertEquals("Exception occurred", collectionAudit.getExceptions());
        assertEquals("localhost:9092", collectionAudit.getBootstrapServer());
    }
}