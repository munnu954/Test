import static org.mockito.ArgumentMatchers.any;
import static org.mockito.Mockito.*;

import org.junit.jupiter.api.Test;
import org.springframework.kafka.core.KafkaTemplate;

class KafkaProducerTest {

    @Test
    void testSendMessage() {
        KafkaTemplate<String, SpaceCollector> kafkaTemplate = mock(KafkaTemplate.class);
        KafkaProducer producer = new KafkaProducer();
        producer.setKafkaTemplate(kafkaTemplate);
        SpaceCollector message = new SpaceCollector();
        message.setId(1);
        message.setUrl("http://example.com");
        message.setPort(8080);
        message.setInputFilePath("/path/to/input/file");
        message.setOutputFilePath("/path/to/output/file");
        message.setDelimiters("|");
        message.setFileType("csv");
        
        // Update the sendMessage method to handle the null kafkaTemplate
        if (producer.getKafkaTemplate() != null) {
            producer.sendMessage(message);
            verify(kafkaTemplate, times(1)).send(any(), eq(message));
        } else {
            throw new NullPointerException("KafkaTemplate is null");
        }
    }
}