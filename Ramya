public class CsvtoJsonTonesTransformer implements FlatMapFunction<Tuple1<String>, String> {
    private String[] headers; // to store CSV headers

    @Override
    public void flatMap(Tuple1<String> csvTuple, Collector<String> collector) {
        if (headers == null) {
            // First tuple, extract headers
            headers = csvTuple.f0.split(","); // assuming CSV columns are comma-separated
        } else {
            // Create a JSON structure based on the CSV header
            StringBuilder jsonBuilder = new StringBuilder("{\n");

            for (int i = 0; i < headers.length; i++) {
                jsonBuilder.append("\"").append(headers[i]).append("\":\"").append(csvTuple.f0.split(",")[i]).append("\",\n");
            }

            // Remove the trailing comma for the last field
            jsonBuilder.setLength(jsonBuilder.length() - 2);

            jsonBuilder.append("}");

            collector.collect(jsonBuilder.toString());
        }
    }
}