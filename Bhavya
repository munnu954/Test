You can create the 'poll' method in the KafkaProducerService class as follows:

```java
public Optional<SpaceCollector> poll(int timeout) {
    Consumer<String, SpaceCollector> consumer = createConsumer();
    consumer.subscribe(Collections.singletonList(topicName));

    ConsumerRecords<String, SpaceCollector> records = consumer.poll(Duration.ofMillis(timeout));

    if (records.isEmpty()) {
        return Optional.empty();
    }

    SpaceCollector spaceCollector = records.iterator().next().value();
    consumer.commitSync();
    consumer.close();

    return Optional.ofNullable(spaceCollector);
}

private Consumer<String, SpaceCollector> createConsumer() {
    Properties props = new Properties();
    props.setProperty(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");
    props.setProperty(ConsumerConfig.GROUP_ID_CONFIG, "test-group");
    props.setProperty(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());
    props.setProperty(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, JsonDeserializer.class.getName());
    props.setProperty(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "earliest");

    return new KafkaConsumer<>(props);
}
```

Note: You need to modify the Kafka consumer properties according to your setup and requirements.