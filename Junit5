@Test
void testApplyPostingRuleWithTopologyDataAndAlarmedObject() {
    Alarm alarm = new Alarm();
    PostingRule rule = new PostingRule();
    HashMap<String, Object> alarmMap = new HashMap<>();
    String componentId = "123";
    String topologyData = "{\"topologyObjects\": [{\"MO_Type\": \"test\", \"TagSequence\": \"test\", \"Name\": \"test\"}]}";
    String alarmedObject = "test";
    String alarmedObjectDetails = "{\"key\": \"value\"}";

    Mockito.when(postingRuleProcessingService.getComponentIdForTopoTraversal(alarmMap, rule)).thenReturn(componentId);
    Mockito.when(utils.evaluateExpression(Mockito.anyString(), Mockito.anyMap())).thenReturn(alarmedObject).thenReturn(alarmedObjectDetails);
    Mockito.when(topoApiClient.fetchTopologyTraversalDetails(alarm, rule, componentId))
           .thenReturn(new ResponseEntity<>(topologyData, HttpStatus.OK));

    Alarm result = postingRuleProcessingService.applyPostingRule(alarm, rule, alarmMap);
    Assertions.assertEquals(alarmedObject, result.getAlarmedObject());
    Assertions.assertEquals(alarmedObjectDetails, result.getTopologyDetails());
}