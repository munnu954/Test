import java.util.Collections;
import java.util.UUID;
import org.joda.time.DateTime;

public UnifiedAuditMessage logMetadata(UnifiedAuditMessage auditMsg, String fileType, ResponseEntity errorMessage) {
    return new UnifiedAuditMessage(auditMsg.getInputFilePath(), auditMsg.getUrl(), auditMsg.getPort(), auditMsg.getOutputFilePath(), 
            auditMsg.getDelimiters(), fileType, 
            DateTime.now(), DateTime.now(), 
            auditMsg.getNo_of_records_in_the_file(), auditMsg.getNo_of_records_processed(), auditMsg.getNo_of_records_failed(), 
            UUID.randomUUID(), UUID.randomUUID(), 
            Collections.singletonList(errorMessage.getStatusCode().toString()), 
            auditMsg.getCollector_id(), 
            JobStatus.COLLECTION_FAILED);
}

public UnifiedAuditMessage logMetadata(UnifiedAuditMessage auditMsg, String fileType, Exception e) {
    return new UnifiedAuditMessage(auditMsg.getInputFilePath(), auditMsg.getUrl(), auditMsg.getPort(), auditMsg.getOutputFilePath(), 
            auditMsg.getDelimiters(), fileType, 
            DateTime.now(), DateTime.now(), 
            auditMsg.getNo_of_records_in_the_file(), auditMsg.getNo_of_records_processed(), auditMsg.getNo_of_records_failed(), 
            UUID.randomUUID(), UUID.randomUUID(), 
            Collections.singletonList("Exception: " + e.getMessage()), 
            auditMsg.getCollector_id(), 
            JobStatus.COLLECTION_FAILED);
}