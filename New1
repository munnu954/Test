// Positive Scenario
@Test
public void testUploadTextToJsonJob() {
// Create Flink Cluster instance
FlinkCluster flinkCluster = new FlinkCluster("localhost", 8081);

// Create TextToJsonJob instance
TextToJsonJob textToJsonJob = new TextToJsonJob();

// Upload TextToJsonJob to flink cluster
boolean isUploaded = flinkCluster.uploadJob(textToJsonJob);

assertTrue(isUploaded);
}

@Test
public void testSubmitTextToJsonTask() {
// Create Flink Cluster instance
FlinkCluster flinkCluster = new FlinkCluster("localhost", 8081);

// Create TextToJsonJob instance
TextToJsonJob textToJsonJob = new TextToJsonJob();

// Upload TextToJsonJob to flink cluster
boolean isUploaded = flinkCluster.uploadJob(textToJsonJob);

assertTrue(isUploaded);

// Create TextToJsonTask instance
TextToJsonTask textToJsonTask = new TextToJsonTask();

// Submit TextToJsonTask to TextToJsonJob
boolean isSubmitted = textToJsonJob.submitTask(textToJsonTask);

assertTrue(isSubmitted);

// Validate generated json
String expectedJson = "{\"name\":\"John\",\"age\":30,\"city\":\"New York\"}";
String actualJson = textToJsonTask.getGeneratedJson();

assertEquals(expectedJson, actualJson);
}

// Negative Scenario
@Test
public void testUploadTextToJsonJobFailure() {
// Create Flink Cluster instance
FlinkCluster flinkCluster = new FlinkCluster("localhost", 8081);

// Create TextToJsonJob instance with invalid configuration
TextToJsonJob textToJsonJob = new TextToJsonJob();
textToJsonJob.setConfiguration(null);

// Try to upload TextToJsonJob to flink cluster
boolean isUploaded = flinkCluster.uploadJob(textToJsonJob);

assertFalse(isUploaded);
}

@Test
public void testSubmitTextToJsonTaskFailure() {
// Create Flink Cluster instance
FlinkCluster flinkCluster = new FlinkCluster("localhost", 8081);

// Create TextToJsonJob instance
TextToJsonJob textToJsonJob = new TextToJsonJob();

// Upload TextToJsonJob to flink cluster
boolean isUploaded = flinkCluster.uploadJob(textToJsonJob);

assertTrue(isUploaded);

// Create TextToJsonTask instance with invalid input
TextToJsonTask textToJsonTask = new TextToJsonTask(null);

// Try to submit TextToJsonTask to TextToJsonJob
boolean isSubmitted = textToJsonJob.submitTask(textToJsonTask);

assertFalse(isSubmitted);
}