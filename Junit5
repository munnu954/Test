import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

public class FlinkJobCompositePKTest {

    @Test
    void equalsAndHashCodeTest() {
        FlinkJobCompositePK pk1 = new FlinkJobCompositePK("path1", "path2", FlinkFileTypes.TXT, true);
        FlinkJobCompositePK pk2 = new FlinkJobCompositePK("path1", "path2", FlinkFileTypes.TXT, true);
        FlinkJobCompositePK pk3 = new FlinkJobCompositePK("path1", "path3", FlinkFileTypes.TXT, true);

        // Equals test
        assertTrue(pk1.equals(pk2));
        assertFalse(pk1.equals(pk3));

        // HashCode test
        assertEquals(pk1.hashCode(), pk2.hashCode());
    }

    @Test
    void constructorAndGettersTest() {
        FlinkJobCompositePK pk = new FlinkJobCompositePK("path1", "path2", FlinkFileTypes.TXT, true);

        assertEquals("path1", pk.getFlinkJarFilePath());
        assertEquals("path2", pk.getSharedLocationJarFilePath());
        assertEquals(FlinkFileTypes.TXT, pk.getType());
        assertTrue(pk.getEnabled());
    }

    @Test
    void settersTest() {
        FlinkJobCompositePK pk = new FlinkJobCompositePK();
        
        pk.setFlinkJarFilePath("newPath");
        pk.setSharedLocationJarFilePath("newPath");
        pk.setType(FlinkFileTypes.CSV);
        pk.setEnabled(false);

        assertEquals("newPath", pk.getFlinkJarFilePath());
        assertEquals("newPath", pk.getSharedLocationJarFilePath());
        assertEquals(FlinkFileTypes.CSV, pk.getType());
        assertFalse(pk.getEnabled());
    }

    @Test
    void enumTest() {
        assertEquals(FlinkFileTypes.valueOf("TXT"), FlinkFileTypes.TXT);
        assertEquals(FlinkFileTypes.values().length, 3);
    }
}