import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotEquals;

public class FlinkJobCompositePKTest {

    @Test
    public void testEqualsAndHashCode() {
        FlinkJobCompositePK pk1 = new FlinkJobCompositePK("path1", "sharedPath1", FlinkFileTypes.TXT, true);
        FlinkJobCompositePK pk2 = new FlinkJobCompositePK("path1", "sharedPath1", FlinkFileTypes.TXT, true);
        FlinkJobCompositePK pk3 = new FlinkJobCompositePK("path2", "sharedPath2", FlinkFileTypes.CSV, false);

        // Testing equals
        assertEquals(pk1, pk2);
        assertNotEquals(pk1, pk3);

        // Testing hashCode
        assertEquals(pk1.hashCode(), pk2.hashCode());
        assertNotEquals(pk1.hashCode(), pk3.hashCode());
    }

    @Test
    public void testNotEquals() {
        FlinkJobCompositePK pk1 = new FlinkJobCompositePK(null, "sharedPath1", FlinkFileTypes.TXT, true);
        FlinkJobCompositePK pk2 = new FlinkJobCompositePK("path1", "sharedPath1", FlinkFileTypes.CSV, true);

        assertNotEquals(pk1, pk2);
    }

    @Test
    public void testNullEquals() {
        FlinkJobCompositePK pk1 = new FlinkJobCompositePK(null, null, null, null);
        FlinkJobCompositePK pk2 = new FlinkJobCompositePK(null, null, null, null);

        assertEquals(pk1, pk2);
    }
}