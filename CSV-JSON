@Autowired
    private FlinkApiController flinkApiController;

    @Test
    public void testTriggerJobSuccess() throws Exception {
        UnifiedAuditMessage auditMsg = new UnifiedAuditMessage();
        auditMsg.setInputFilePath("test.csv");
        String fileType = ".csv";

        when(kafkaAuditProducer.createMessageAndLog(anyString(), anyString(), anyInt(), anyString(), anyString(), anyString(), anyString(), anyInt(), anyInt(), anyInt(), anyString(), anyString(), anyString(), anyList(), anyString()))
                .thenReturn("Message sent successfully");

        String result = flinkApiController.triggerJob(auditMsg, fileType);

        verify(kafkaAuditProducer, times(1)).createMessageAndLog(eq(auditMsg.getInputFilePath()), eq(auditMsg.getUrl()), eq(auditMsg.getPort()), eq(auditMsg.getOutputFilePath()), eq(auditMsg.getDelimiters()), eq(fileType), anyString(), eq(auditMsg.getNo_of_records_in_the_file()), eq(auditMsg.getNo_of_records_processed()), eq(auditMsg.getNo_of_records_failed()), eq(auditMsg.getJob_id()), eq(auditMsg.getJar_id()), eq(auditMsg.getCollector_id()), eq(auditMsg.getExceptions()), eq(JobStatus.FLINK_JOB_SUBMITTED.toString()));
        assertEquals("Job submitted", result);
    }