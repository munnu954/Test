import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

public class CollectionAuditTest {

    @Test
    public void testCollectionAuditBuilder() {
        CollectionAudit collectionAudit = CollectionAudit.builder()
                .id("1")
                .collectorId("C001")
                .processType(ProcessType.Collector)
                .jarId("J001")
                .jobId("JOB001")
                .flinkJobId("FJ001")
                .jobStatus("COMPLETED")
                .inputFilePath("input.txt")
                .outputFilePath("output.txt")
                .auditTopic("topic")
                .url("http://example.com")
                .flinkURL("http://flink.com")
                .port(8080)
                .delimiters(",")
                .fileType("CSV")
                .dateReceived("2021-10-01")
                .dateProcessed("2021-10-02")
                .noOfRecordsInTheFile(100)
                .noOfRecordsProcessed(90)
                .noOfRecordsFailed(10)
                .exceptions("Error occurred")
                .bootstrapServer("localhost:9092")
                .build();

        assertNotNull(collectionAudit);
        assertEquals("1", collectionAudit.getId());
        assertEquals("C001", collectionAudit.getCollectorId());
        assertEquals(ProcessType.Collector, collectionAudit.getProcessType());
        assertEquals("J001", collectionAudit.getJarId());
        assertEquals("JOB001", collectionAudit.getJobId());
        assertEquals("FJ001", collectionAudit.getFlinkJobId());
        assertEquals("COMPLETED", collectionAudit.getJobStatus());
        assertEquals("input.txt", collectionAudit.getInputFilePath());
        assertEquals("output.txt", collectionAudit.getOutputFilePath());
        assertEquals("http://example.com", collectionAudit.getUrl());
        assertEquals("http://flink.com", collectionAudit.getFlinkURL());
        assertEquals(8080, collectionAudit.getPort());
        assertEquals(",", collectionAudit.getDelimiters());
        assertEquals("CSV", collectionAudit.getFileType());
        assertEquals("2021-10-01", collectionAudit.getDateReceived());
        assertEquals("2021-10-02", collectionAudit.getDateProcessed());
        assertEquals(100, collectionAudit.getNoOfRecordsInTheFile());
        assertEquals(90, collectionAudit.getNoOfRecordsProcessed());
        assertEquals(10, collectionAudit.getNoOfRecordsFailed());
        assertEquals("Error occurred", collectionAudit.getExceptions());
        assertEquals("localhost:9092", collectionAudit.getBootstrapServer());
    }
}