Feature: Retrieve Audit Status Map

  Scenario: Retrieve audit status for files in a directory with multiple chunks
    Given a list of files with more than 1000 entries in the remote directory
    And the lucenceCollectionAuditRepo returns audit statuses for the file paths
    When the getAuditStatusMap method is called with the list of files and the remote directory
    Then the audit status map should contain the audit statuses for all file paths

  Scenario: Retrieve audit status for files in a directory with a single chunk
    Given a list of files with less than or equal to 1000 entries in the remote directory
    And the lucenceCollectionAuditRepo returns audit statuses for the file paths
    When the getAuditStatusMap method is called with the list of files and the remote directory
    Then the audit status map should contain the audit statuses for all file paths

  Scenario: Retrieve audit status for files with no matching audits
    Given a list of files in the remote directory
    And the lucenceCollectionAuditRepo returns no audit statuses for the file paths
    When the getAuditStatusMap method is called with the list of files and the remote directory
    Then the audit status map should be empty

  Scenario: Retrieve audit status for an empty list of files
    Given an empty list of files
    When the getAuditStatusMap method is called with the empty list and any remote directory
    Then the audit status map should be empty

  Scenario: Handle null audits in the list
    Given a list of files in the remote directory
    And the lucenceCollectionAuditRepo returns some null audits for the file paths
    When the getAuditStatusMap method is called with the list of files and the remote directory
    Then the audit status map should not contain any entries for null audits

  Scenario: Handle a mix of files and directories
    Given a list of files and directories in the remote directory
    And the lucenceCollectionAuditRepo returns audit statuses for the file paths excluding directories
    When the getAuditStatusMap method is called with the list of files and the remote directory
    Then the audit status map should contain the audit statuses for file paths only, excluding directories
