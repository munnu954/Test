@Test
public void testKafkaConsumerSuccess() {
    // Arrange
    String topic = "test-topic";
    String key = "key";
    String value = "value";
    ConsumerRecord<String, String> record = new ConsumerRecord<>(topic, 0, 0, key, value);
    List<ConsumerRecord<String, String>> recordsList = Collections.singletonList(record);
    ConsumerRecords<String, String> records = new ConsumerRecords<>(new HashMap<>());

    // Act
    when(consumer.poll(any(Duration.class))).thenReturn(records);

    // Assert
    ConsumerRecords<String, String> result = consumer.poll(Duration.ofMillis(100));
    verify(consumer, times(1)).poll(any(Duration.class));
    assertTrue(result.records(topic).containsAll(recordsList) && recordsList.containsAll(result.records(topic)));
}