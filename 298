@Test
void consume_ShouldNotWriteToExternalFileAndAuditQueue_WhenInputFileExistsAndTopicAccessible() throws IOException, ExecutionException, InterruptedException {
    // Arrange
    KafkaConsumer kafkaConsumer = new KafkaConsumer();
    kafkaConsumer.util = util;

    when(util.isKafkaTopicPresent(any())).thenReturn(false); // Simulating topic accessible
    doNothing().when(kafkaConsumer).writeLogToFile(any(), any());

    SpaceCollector spaceCollector = new SpaceCollector();
    spaceCollector.setInputFilePath("C:/Temp/input.xml");
    String data = "{\"inputFilePath\":\"C:/Temp/input.xml\"}";

    kafkaConsumer.kafkaInputProducer = mock(KafkaInputProducer.class);

    // Act
    kafkaConsumer.consume(data);

    // Assert
    verify(kafkaConsumer, never()).writeLogToFile(any(), any());
    verify(kafkaConsumer.kafkaInputProducer, never()).sendFailureMessage(any(), any(), any());
}