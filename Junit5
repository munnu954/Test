
@Test
public void testParse_NoMatch() throws JsonMappingException, JsonProcessingException {
    String value = "This is a string with no matches.";
    Map srcMap = new HashMap<>();
    String ruleName = "ruleName";

    String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

    assertEquals("This is a string with no matches.", result);
}

@Test
public void testParse_SingleMatch() throws JsonMappingException, JsonProcessingException {
    String value = "This is a string with a single match: {'key': 'value'}";
    Map srcMap = new HashMap<>();
    srcMap.put("key", "value");
    String ruleName = "ruleName";

    String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

    assertEquals("This is a string with a single match: value", result);
}

@Test
public void testParse_MultipleMatches() throws JsonMappingException, JsonProcessingException {
    String value = "This is a string with multiple matches: {'key1': 'value1', 'key2': 'value2'}";
    Map srcMap = new HashMap<>();
    srcMap.put("key1", "value1");
    srcMap.put("key2", "value2");
    String ruleName = "ruleName";

    String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

    assertEquals("This is a string with multiple matches: value1, value2", result);
}

@Test
public void testParse_ArrayMatch() throws JsonMappingException, JsonProcessingException {
    String value = "This is a string with an array match: ['value1', 'value2']";
    Map srcMap = new HashMap<>();
    srcMap.put("array", Arrays.asList("value1", "value2"));
    String ruleName = "ruleName";

    String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

    assertEquals("This is a string with an array match: value1, value2", result);
}

@Test
public void testParse_ArrayIndexMatch() throws JsonMappingException, JsonProcessingException {
    String value = "This is a string with an array index match: [0]";
    Map srcMap = new HashMap<>();
    srcMap.put("array", Arrays.asList("value1", "value2"));
    String ruleName = "ruleName";

    String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

    assertEquals("This is a string with an array index match: value1", result);
}

@Test
public void testParse_ArrayIndexMatch_Negative() throws JsonMappingException, JsonProcessingException {
    String value = "This is a string with an array index match: [-1]";
    Map srcMap = new HashMap<>();
    srcMap.put("array", Arrays.asList("value1", "value2"));
    String ruleName = "ruleName";

    String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

    assertEquals("This is a string with an array index match: ", result);
}

@Test
public void testParse_ArrayIndexMatch_OutofBounds() throws JsonMappingException, JsonProcessingException {
    String value = "This is a string with an array index match: [3]";
    Map srcMap = new HashMap<>();
    srcMap.put("array", Arrays.asList("value1", "value2"));
    String ruleName = "ruleName";

    String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

    assertEquals("This is a string with an array index match: ", result);
}