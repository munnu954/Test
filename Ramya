public static class CsvToJsonMapper implements MapFunction<Tuple, String> {
        private String[] headers; // to store CSV headers

        @Override
        public String map(Tuple csvTuple) {
            if (headers == null) {
                // First tuple, extract headers
                headers = new String[csvTuple.getArity()];
                for (int i = 0; i < csvTuple.getArity(); i++) {
                    headers[i] = csvTuple.getField(i).toString();
                }
            } else {
                // Create a JSON structure based on the CSV header
                StringBuilder jsonBuilder = new StringBuilder("{\n");

                for (int i = 0; i < csvTuple.getArity(); i++) {
                    jsonBuilder.append("\"").append(headers[i]).append("\":\"").append(csvTuple.getField(i)).append("\",\n");
                }

                // Remove the trailing comma for the last field
                jsonBuilder.deleteCharAt(jsonBuilder.length() - 2);

                jsonBuilder.append("}");

                return jsonBuilder.toString();
            }

            return null; // Skip the first tuple (header)
        }
    }