Here are some testing code for the negative scenarios mentioned above:

1. The Kafka topic 3459-DEV-COLLECTION-JSON-DATA-QUEUE is not present:


public void testKafkaTopicNotPresent() throws Exception {

// Arrange

String bootstarpServer = "localhost:9092";

String topic = "3459-DEV-COLLECTION-JSON-DATA-QUEUE";

// Act

try {

Main.main(new String[] {"--bootstarpServer", bootstarpServer, "--topic", topic});

} catch (Exception e) {

// Assert

assertEquals("Topic 3459-DEV-COLLECTION-JSON-DATA-QUEUE does not exist", e.getMessage());

}

}


2. The Kafka topic 3459-DEV-COLLECTION-JSON-DATA-QUEUE is not accessible:


public void testKafkaTopicNotAccessible() throws Exception {

// Arrange

String bootstarpServer = "localhost:9092";

String topic = "3459-DEV-COLLECTION-JSON-DATA-QUEUE";

// Act

try {

Main.main(new String[] {"--bootstarpServer", bootstarpServer, "--topic", topic});

} catch (Exception e) {

// Assert

assertEquals("Could not connect to Kafka topic 3459-DEV-COLLECTION-JSON-DATA-QUEUE", e.getMessage());

}

}


3. The Kafka topic 3459-DEV-COLLECTION-AUDIT-QUEUE is not present:


public void testKafkaTopicAuditQueueNotPresent() throws Exception {

// Arrange

String bootstarpServer = "localhost:9092";

String topic = "3459-DEV-COLLECTION-AUDIT-QUEUE";

// Act

try {

Main.main(new String[] {"--bootstarpServer", bootstarpServer, "--topic", topic});

} catch (Exception e) {

// Assert

assertEquals("Topic 3459-DEV-COLLECTION-AUDIT-QUEUE does not exist", e.getMessage());

}

}


4. The Kafka topic 3459-DEV-COLLECTION-AUDIT-QUEUE is not accessible:


public void testKafkaTopicAuditQueueNotAccessible() throws Exception {

// Arrange

String bootstarpServer = "localhost:9092";

String topic = "3459-DEV-COLLECTION-AUDIT-QUEUE";

// Act

try {

Main.main(new String[] {"--bootstarpServer", bootstarpServer, "--topic", topic});

} catch (Exception e) {

// Assert

assertEquals("Could not connect to Kafka topic 3459-DEV-COLLECTION-AUDIT-QUEUE", e.getMessage());

}

}


5. The data read for ProgramArgsList does not contain valid params:


public void testProgramArgsListDoesNotContainValidParams() throws Exception {

// Arrange

String bootstarpServer = "localhost:9092";

String topic = "3459-DEV-COLLECTION-JSON-DATA-QUEUE";

String[] args = {"--bootstarpServer", bootstarpServer};

// Act

try {

Main.main(args);

} catch (Exception e) {

// Assert

assertEquals("Invalid program arguments: --topic must be specified", e.getMessage());

}

}


6. The data read for ProgramArgsList contain valid params with invalid values:

``
public void testProgramArgsListContainsValidParamsWithInvalidValues() throws Exception {

// Arrange

String bootstarpServer = "localhost:9092";

String topic = "3459-DEV-COLLECTION-JSON-DATA-QUEUE";

String[] args = {"--bootstarpServer", bootstarpServer, "--topic", "invalid-topic"};

// Act

try {

Main.main(args);

} catch (Exception e) {

// Assert

assertEquals("Invalid program arguments: Topic invalid-topic does not exist", e.getMessage());

}

}
`