@Override
public void flatMap(String s, Collector<String> collector) throws Exception {
    String[] lines = s.split(System.lineSeparator());
    if (headers == null) {
        headers = lines[0].split(","); // Store the header row for key names
        return; // Skip processing the header row
    }
  
    JSONObject obj = new JSONObject();
    String[] keys = headers; // Extracting the keys from the first row
    for (String line : lines) {
        String[] values = line.split(",");
        JSONObject subObj = new JSONObject();
        for (int i = 0; i < keys.length; i++) {
            String jsonKey = keys[i].trim().replace("\"", "");
            String jsonValue = values[i].trim().replace("\"", "");
            subObj.put(jsonKey, jsonValue);
        }
        obj.put(subObj.getString("ObjectName"), subObj);
    }
    collector.collect(obj.toString());
}