import org.apache.flink.api.common.functions.FlatMapFunction;
import org.apache.flink.api.java.tuple.Tuple2;
import org.apache.flink.util.Collector;
import org.json.JSONObject;

public class TexttoJsonTransformer implements FlatMapFunction<String, String> {

  @Override
  public void flatMap(String s, Collector<String> collector) throws Exception {
    s = s.replace("{", "").replace("}", "").replace("\"", "");
    String[] arr = s.split(",");
    JSONObject obj = new JSONObject();
    
    for (String input : arr) {
      String[] keyValue = input.split(":");
      String key = keyValue[0].trim();
      String value = keyValue[1].trim();
      obj.put(key, value);
    }
    
    collector.collect(obj.toString());
  }
}



public class TexttoJsonTransformer implements FlatMapFunction<String, String> {

  @Override
  public void flatMap(String s, Collector<String> collector) throws Exception {
    String[] arr = s.split(",");
    JSONObject obj = new JSONObject();
    
    for (String input : arr) {
      String[] keyValue = input.split(":");
      String key = keyValue[0].trim();
      String value = keyValue[1].trim();
      
      if (value.charAt(0) == '"') {
        value = value.substring(1, value.length() - 1);
      } else if (value.equals(" true")) {
        value = "true";
      } else if (value.equals(" false")) {
        value = "false";
      }
      
      obj.put(key, value);
    }
    
    collector.collect(obj.toString());
  }
}