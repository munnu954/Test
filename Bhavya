public class TexttoJsonTransformer implements FlatMapFunction<String, String> {

@Override
public void flatMap(String s, Collector<String> collector) throws Exception {
JSONObject obj = new JSONObject();
String[] arr = s.split(",");

for (String input : arr) {
    String[] keyValue = input.split(":");
    String key = keyValue[0].trim().replaceAll("\"", "");
    String value = keyValue[1].trim().replaceAll("\"", "");
    if (value.matches("\\d+")) {
        obj.put(key, Integer.parseInt(value));
    } else {
        obj.put(key, value);
    }
}
collector.collect(obj.toString());
}
}