import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class CollectionAuditTest {

    @Test
    void testBuilder_AllFields() {
        CollectionAudit audit = CollectionAudit.builder()
                .id("123")
                .collectorId("collector1")
                .processType(ProcessType.Collector)
                .jarId("jar1")
                .jobId("job1")
                .flinkJobId("flinkJob1")
                .jobStatus("RUNNING")
                .inputFilePath("input.txt")
                .outputFilePath("output.txt")
                .auditTopic("auditTopic")
                .url("http://example.com")
                .flinkURL("http://flink.example.com")
                .port(8080)
                .delimiters(",")
                .fileType("csv")
                .dateReceived("2023-10-26")
                .dateProcessed("2023-10-26")
                .noOfRecordsInTheFile(100)
                .noOfRecordsProcessed(90)
                .noOfRecordsFailed(10)
                .exceptions("Some exceptions")
                .bootstrapServer("localhost:9092")
                .build();

        assertEquals("123", audit.getId());
        assertEquals("collector1", audit.getCollectorId());
        assertEquals(ProcessType.Collector, audit.getProcessType());
        assertEquals("jar1", audit.getJarId());
        assertEquals("job1", audit.getJobId());
        assertEquals("flinkJob1", audit.getFlinkJobId());
        assertEquals("RUNNING", audit.getJobStatus());
        assertEquals("input.txt", audit.getInputFilePath());
        assertEquals("output.txt", audit.getOutputFilePath());
        assertEquals("auditTopic", audit.getAuditTopic());
        assertEquals("http://example.com", audit.getUrl());
        assertEquals("http://flink.example.com", audit.getFlinkURL());
        assertEquals(8080, audit.getPort());
        assertEquals(",", audit.getDelimiters());
        assertEquals("csv", audit.getFileType());
        assertEquals("2023-10-26", audit.getDateReceived());
        assertEquals("2023-10-26", audit.getDateProcessed());
        assertEquals(100, audit.getNoOfRecordsInTheFile());
        assertEquals(90, audit.getNoOfRecordsProcessed());
        assertEquals(10, audit.getNoOfRecordsFailed());
        assertEquals("Some exceptions", audit.getExceptions());
        assertEquals("localhost:9092", audit.getBootstrapServer());
    }

    @Test
    void testBuilder_NoFields() {
        CollectionAudit audit = CollectionAudit.builder().build();

        assertNull(audit.getId());
        assertNull(audit.getCollectorId());
        assertNull(audit.getProcessType());
        assertNull(audit.getJarId());
        assertNull(audit.getJobId());
        assertNull(audit.getFlinkJobId());
        assertNull(audit.getJobStatus());
        assertNull(audit.getInputFilePath());
        assertNull(audit.getOutputFilePath());
        assertNull(audit.getAuditTopic());
        assertNull(audit.getUrl());
        assertNull(audit.getFlinkURL());
        assertNull(audit.getPort());
        assertNull(audit.getDelimiters());
        assertNull(audit.getFileType());
        assertNull(audit.getDateReceived());
        assertNull(audit.getDateProcessed());
        assertNull(audit.getNoOfRecordsInTheFile());
        assertNull(audit.getNoOfRecordsProcessed());
        assertNull(audit.getNoOfRecordsFailed());
        assertNull(audit.getExceptions());
        assertNull(audit.getBootstrapServer());
    }

    @Test
    void testBuilder_PartialFields() {
        CollectionAudit audit = CollectionAudit.builder()
                .id("123")
                .collectorId("collector1")
                .processType(ProcessType.Collector)
                .build();

        assertEquals("123", audit.getId());
        assertEquals("collector1", audit.getCollectorId());
        assertEquals(ProcessType.Collector, audit.getProcessType());
        assertNull(audit.getJarId());
        assertNull(audit.getJobId());
        assertNull(audit.getFlinkJobId());
        assertNull(audit.getJobStatus());
        assertNull(audit.getInputFilePath());
        assertNull(audit.getOutputFilePath());
        assertNull(audit.getAuditTopic());
        assertNull(audit.getUrl());
        assertNull(audit.getFlinkURL());
        assertNull(audit.getPort());
        assertNull(audit.getDelimiters());
        assertNull(audit.getFileType());
        assertNull(audit.getDateReceived());
        assertNull(audit.getDateProcessed());
        assertNull(audit.getNoOfRecordsInTheFile());
        assertNull(audit.getNoOfRecordsProcessed());
        assertNull(audit.getNoOfRecordsFailed());
        assertNull(audit.getExceptions());
        assertNull(audit.getBootstrapServer());
    }
