
@Test
public void testParse_noMatch() throws JsonMappingException, JsonProcessingException {
  String value = "this is a string";
  Map srcMap = new HashMap<>();
  String ruleName = "ruleName";

  String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

  assertEquals("this is a string", result);
}

@Test
public void testParse_matchWithNoArrayIndex() throws JsonMappingException, JsonProcessingException {
  String value = "this is a string with a match: {'key': 'value'}";
  Map srcMap = new HashMap<>();
  srcMap.put("key", "value");
  String ruleName = "ruleName";

  String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

  assertEquals("this is a string with a match: value", result);
}

@Test
public void testParse_matchWithArrayIndex() throws JsonMappingException, JsonProcessingException {
  String value = "this is a string with a match: {'key': ['value1', 'value2']}";
  Map srcMap = new HashMap<>();
  srcMap.put("key", Arrays.asList("value1", "value2"));
  String ruleName = "ruleName";

  String result = AlarmPostingUtils.parse(value, srcMap, ruleName);

  assertEquals("this is a string with a match: value1, value2", result);
}

@Test
public void testParse_matchWithArrayIndex_negativeIndex() throws JsonMappingException, JsonProcessingException {
  String value = "this is a string with a match: {'key': ['value1', 'value2']}";
  Map srcMap = new HashMap<>();
  srcMap.put("key", Arrays.asList("value1", "value2"));
  String ruleName = "ruleName";

  String result = AlarmPostingUtils.parse(value, srcMap, ruleName, -1);

  assertEquals("this is a string with a match: value1, value2", result);
}

@Test
public void testParse_matchWithArrayIndex_outOfBoundsIndex() throws JsonMappingException, JsonProcessingException {
  String value = "this is a string with a match: {'key': ['value1', 'value2']}";
  Map srcMap = new HashMap<>();
  srcMap.put("key", Arrays.asList("value1", "value2"));
  String ruleName = "ruleName";

  String result = AlarmPostingUtils.parse(value, srcMap, ruleName, 3);

  assertEquals("this is a string with a match: value1, value2", result);
}