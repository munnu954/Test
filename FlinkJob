@Override
public void flatMap(String s, Collector<String> collector) throws Exception {
String[] headers = s.split(",");
JSONObject obj=new JSONObject();
int i =1;
String jsonkey;
for (String input:headers) {
jsonkey = headers[i-1];
obj.put(jsonkey, input);
i++;
}
collector.collect(obj.toString());
}