public class KafkaProducerService {

    private final KafkaProducer<String, String> producer;

    public KafkaProducerService(KafkaProducer<String, String> producer) {
        this.producer = producer;
    }

    public void poll(int numRecords) {
        for (int i = 0; i < numRecords; i++) {
            String key = "key" + i;
            String value = "value" + i;
            producer.send(new ProducerRecord<>("topic", key, value));
        }
    }
}