import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.http.HttpStatus;
import org.springframework.web.client.HttpClientErrorException;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.eq;
import static org.mockito.Mockito.*;

public class FlinkApiControllerTest {
    
    private FlinkApiController flinkApiController;

    private RestTemplate restTemplate;
    
    @BeforeEach
    public void setUp() {
        restTemplate = mock(RestTemplate.class);
        flinkApiController = new FlinkApiController(restTemplate);
    }

    @Test
    void testTriggerJob_Failure_HttpClientErrorException() {
        // Arrange
        SpaceCollector collector = new SpaceCollector();
        collector.setInputFilePath("test.csv");
        String fileType = ".csv";
        String programArgs = "--input |inputPath|";
        String jobSubmitUrl = "http://flink-api-url/jars/non-existent-jar-id/run";
        HttpClientErrorException exception = new HttpClientErrorException(HttpStatus.NOT_FOUND);
        when(restTemplate.postForEntity(eq(jobSubmitUrl), any(), eq(String.class))).thenThrow(exception);

        // Act
        String result = flinkApiController.triggerJob(collector, fileType);

        // Assert
        assertEquals("Job is not triggered", result);
        verify(restTemplate, times(1)).postForEntity(eq(jobSubmitUrl), any(), eq(String.class));
    }

    @Test
    void testTriggerJob_Failure_RuntimeException() {
        // Arrange
        SpaceCollector collector = new SpaceCollector();
        collector.setInputFilePath("test.csv");
        String fileType = ".csv";
        String programArgs = "--input |inputPath|";
        String jobSubmitUrl = "http://flink-api-url/jars/flink-job-jar-id/run";
        RuntimeException exception = new RuntimeException("Internal Server Error");
        when(restTemplate.postForEntity(eq(jobSubmitUrl), any(), eq(String.class))).thenThrow(exception);

        // Act
        String result = flinkApiController.triggerJob(collector, fileType);

        // Assert
        assertEquals("Job is not triggered", result);
        verify(restTemplate, times(1)).postForEntity(eq(jobSubmitUrl), any(), eq(String.class));
    }
}

Note: Please make sure to import the necessary classes (e.g., FlinkApiController, RestTemplate, SpaceCollector) as per your project structure.