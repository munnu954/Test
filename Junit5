@Test
public void testMainNoException() {
    // Arrange
    SpringApplication app = Mockito.mock(SpringApplication.class);
    ConfigurableApplicationContext appContext = Mockito.mock(ConfigurableApplicationContext.class);

    Mockito.when(app.run(Mockito.any())).thenReturn(appContext);

    // Act
    CBRSSuppressionApplication.main(new String[] {"arg1", "arg2"});

    // Assert
    Mockito.verify(app, Mockito.times(1)).run(Mockito.any());
    Mockito.verify(appContext, Mockito.times(1)).getBean(AlarmConsumer.class);
    Mockito.verify(appContext, Mockito.times(1)).getBean(MessageReaderService.class);
}

@Test
public void testMainUnsatisfiedDependencyException() {
    // Arrange
    SpringApplication app = Mockito.mock(SpringApplication.class);
    ConfigurableApplicationContext appContext = Mockito.mock(ConfigurableApplicationContext.class);
    UnsatisfiedDependencyException ex = Mockito.mock(UnsatisfiedDependencyException.class);

    Mockito.when(app.run(Mockito.any())).thenThrow(ex);
    Mockito.when(ex.getMessage()).thenReturn("Validation failed for query");

    // Act
    CBRSSuppressionApplication.main(new String[] {"arg1", "arg2"});

    // Assert
    Mockito.verify(app, Mockito.times(1)).run(Mockito.any());
    Mockito.verify(ex, Mockito.times(1)).getMessage();
    Mockito.verify(CBRSSuppressionApplication.logger, Mockito.times(1))
            .error(Mockito.anyString());
}

@Test
public void testMainUnsatisfiedDependencyExceptionNoMessage() {
    // Arrange
    SpringApplication app = Mockito.mock(SpringApplication.class);
    ConfigurableApplicationContext appContext = Mockito.mock(ConfigurableApplicationContext.class);
    UnsatisfiedDependencyException ex = Mockito.mock(UnsatisfiedDependencyException.class);

    Mockito.when(app.run(Mockito.any())).thenThrow(ex);
    Mockito.when(ex.getMessage()).thenReturn(null);

    // Act
    CBRSSuppressionApplication.main(new String[] {"arg1", "arg2"});

    // Assert
    Mockito.verify(app, Mockito.times(1)).run(Mockito.any());
    Mockito.verify(ex, Mockito.times(1)).getMessage();
    Mockito.verify(CBRSSuppressionApplication.logger, Mockito.never())
            .error(Mockito.anyString());
}